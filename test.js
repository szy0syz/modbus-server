const fs = require('fs')

let buf = Buffer.from([0x01, 0x41, 0x00, 0xEF, 0xBF, 0xBD, 0x5B, 0x13, 0xC5, 0x9E, 0x00, 0x00, 0x00, 0x00, 0x01, 0xEF, 0xBF, 0xBD, 0x01, 0xEF, 0xBF, 0xBD, 0x01, 0xEF, 0xBF, 0xBD, 0x01, 0xEF, 0xBF, 0xBD, 0x01, 0xEF, 0xBF, 0xBD, 0x01, 0xEF, 0xBF, 0xBD, 0x01, 0xEF, 0xBF, 0xBD, 0x01, 0xEF, 0xBF, 0xBD, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xBF, 0xBD, 0x03, 0x4D, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x5B, 0x13, 0xEF, 0xBF, 0xBD, 0xEF, 0xBF, 0xBD, 0x00, 0x00, 0x00, 0x00, 0x01, 0xEF, 0xBF, 0xBD, 0x01, 0xEF, 0xBF, 0xBD, 0x01, 0xEF, 0xBF, 0xBD, 0x01, 0xEF, 0xBF, 0xBD, 0x01, 0xEF, 0xBF, 0xBD, 0x01, 0xEF, 0xBF, 0xBD, 0x01, 0xEF, 0xBF, 0xBD, 0x01, 0xEF, 0xBF, 0xBD, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xBF, 0xBD, 0x03, 0xEF, 0xBF, 0xBD, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xBF, 0xBD, 0x16])

console.log(buf.length)

console.log(buf.indexOf('00EF',0, 'hex'))

// const reg = new RegExp(/bfbd/g)

// buf = buf.toString('hex')

// // 删除bdbd的数量
// const counter = buf.match(reg).length

// buf = Buffer.from(buf.replace(reg, ''), 'hex')

// const oriLength = parseInt(buf.slice(2,4).toString('hex'),16)

// let newLength = (oriLength - counter * 2 - 2 -2 -2 - 1)

// newLength = newLength > 255 ? newLength.toString(16) :  '00' + newLength.toString(16)

// buf.write(newLength ,2,2,'hex')

// // console.log(newLength)

// fs.appendFile(
//     'szy.bin',
//     buf,
//     'utf-8',
//     err => {
//       if (err) throw err
//       console.log('The file has been saved!')
//     }
//   )

// console.log(new Date().toLocaleString())